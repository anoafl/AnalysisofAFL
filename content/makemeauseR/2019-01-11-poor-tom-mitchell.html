---
title: Poor Tom Mitchell
author: Robert Nguyen
date: '2019-01-11'
slug: poor-tom-mitchell
categories:
  - fitzRoy
  - R
tags:
  - fantasy
  - graphics
  - Hawthorn
description: 'Hawks lose one of the best'
---



<p>Today unfortunetely one of the games best players and the current Bronwnlow Medalist Tom Mitchell <a href="https://www.abc.net.au/news/2019-01-11/hawthorn-star-brownlow-medallist-tom-mitchell-breaks-leg/10708464">has been injured</a> and will probably miss the whole 2019 AFL season. This is horrible news as he was just coming off arguably his <a href="https://www.abc.net.au/news/2018-09-24/tom-mitchell-wins-brownlow-medal-2018/10300390">best season</a> (winning the Brownlow Medal). He’s an incredibly gifted inside player who through the Hawks savvy recruiting have just gotten him some extra outside players to handball the ball too.</p>
<p>To put in perspective just how good of a season hes had, I thought I’d share some R script and hopefully some of you will have your own take on just how good of a season hes had and just what Hawthorn is missing in 2019.</p>
<div id="contested-possession-king" class="section level1">
<h1>Contested Possession King</h1>
<p>Tom Mitchell we know is a contested possession machine, just how much of a machine was he?</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.1.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.8
## ✔ tidyr   0.8.2     ✔ stringr 1.3.1
## ✔ readr   1.3.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>fitzRoy::player_stats%&gt;%
  filter(Season==2018)%&gt;%
  group_by(Player)%&gt;%
  summarise(meanCP=mean(CP))%&gt;%
  arrange(desc(meanCP))</code></pre>
<pre><code>## # A tibble: 639 x 2
##    Player              meanCP
##    &lt;chr&gt;                &lt;dbl&gt;
##  1 Patrick Cripps        17.9
##  2 Clayton Oliver        16.6
##  3 Nathan Fyfe           16.4
##  4 Tom Mitchell          16.1
##  5 Ben Cunnington        16  
##  6 Jarryd Lyons          14.1
##  7 Patrick Dangerfield   14  
##  8 Josh P. Kennedy       13.9
##  9 Lachie Neale          13.9
## 10 Jack Viney            13.5
## # ... with 629 more rows</code></pre>
</div>
<div id="supercoach-king" class="section level1">
<h1>Supercoach King</h1>
<p>I don’t mean this as what will Tom Mitchell missing be on your fantasy team, what I mean is Supercoach scores are probably the best measure of a good player that we have available in fitzRoy.</p>
<p>We know a few things about SC scores, we don’t know their actual formula that is some champion data secret sauce. But in general it does pass the eye test, good players get good scores. If you were to pick a SC team based only on scores it would <em>probably</em> look pretty good. We also know that on average a game will get to about 3300 which we can verify below.</p>
<pre class="r"><code>library(tidyverse)
check&lt;-fitzRoy::player_stats%&gt;%
  group_by(Match_id)%&gt;%
  summarise(sumSC=sum(SC))%&gt;%
  arrange(desc(sumSC))
summary(check$sumSC)  </code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    3249    3299    3300    3300    3302    3331</code></pre>
<p>So we can see the mean and the median are the same.</p>
<p>Lets see how what % of supercoach scores does Tom Mitchell get per game on average and how does that compare?</p>
<pre class="r"><code>fitzRoy::player_stats%&gt;%
    group_by(Match_id)%&gt;%
    mutate(pertSC=SC/sum(SC))%&gt;%
    group_by(Season, Player)%&gt;%
    summarise(mean=100*mean(pertSC))%&gt;%
  arrange(desc(mean))</code></pre>
<pre><code>## # A tibble: 5,833 x 3
## # Groups:   Season [9]
##    Season Player               mean
##     &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1   2012 Gary Jnr Ablett      4.19
##  2   2014 Gary Jnr Ablett      4.14
##  3   2017 Patrick Dangerfield  4.07
##  4   2014 Tom Rockliff         4.00
##  5   2016 Patrick Dangerfield  4.00
##  6   2010 Brendon Goddard      3.97
##  7   2018 Tom Mitchell         3.95
##  8   2011 Scott Pendlebury     3.93
##  9   2013 Gary Jnr Ablett      3.91
## 10   2010 Gary Jnr Ablett      3.89
## # ... with 5,823 more rows</code></pre>
<p>But just how good are these top 10 years? Lets look at it graphically.</p>
<pre class="r"><code>fitzRoy::player_stats%&gt;%
    group_by(Match_id)%&gt;%
    mutate(pertSC=SC/sum(SC))%&gt;%
    group_by(Season, Player)%&gt;%
    summarise(mean=100*mean(pertSC))%&gt;%
    ggplot(aes(x=mean))+geom_density() + geom_vline(xintercept = 3.89)</code></pre>
<p><img src="/makemeauseR/2019-01-11-poor-tom-mitchell_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>But thats since 2010, what about just in the 2018 season?</p>
<pre class="r"><code>fitzRoy::player_stats%&gt;%
        filter(Season==2018)%&gt;%
      group_by(Match_id)%&gt;%
    mutate(pertSC=SC/sum(SC))%&gt;%
    group_by(Season, Player)%&gt;%
    summarise(mean=100*mean(pertSC))%&gt;%
  arrange(desc(mean))</code></pre>
<pre><code>## # A tibble: 639 x 3
## # Groups:   Season [1]
##    Season Player               mean
##     &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1   2018 Tom Mitchell         3.95
##  2   2018 Brodie Grundy        3.84
##  3   2018 Jackson Macrae       3.77
##  4   2018 Max Gawn             3.77
##  5   2018 Patrick Cripps       3.67
##  6   2018 Nathan Fyfe          3.56
##  7   2018 Patrick Dangerfield  3.47
##  8   2018 Clayton Oliver       3.41
##  9   2018 Rory Laird           3.31
## 10   2018 Lachie Neale         3.26
## # ... with 629 more rows</code></pre>
<p>Lets now join on the player position data.</p>
<pre class="r"><code>library(rvest)</code></pre>
<pre><code>## Loading required package: xml2</code></pre>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre class="r"><code>library(tidyverse)
library(stringr)

cbind.fill &lt;- function(...){
    nm &lt;- list(...) 
    nm &lt;- lapply(nm, as.matrix)
    n &lt;- max(sapply(nm, nrow)) 
    do.call(cbind, lapply(nm, function (x) 
        rbind(x, matrix(, n-nrow(x), ncol(x))))) 
}
page&lt;-read_html(x=&quot;https://www.footywire.com/afl/footy/pp-west-coast-eagles--dominic-sheed&quot;)

player&lt;- page%&gt;%
          html_nodes(&quot;.ldrow .hltitle&quot;)%&gt;%
          html_text()

playing.for&lt;-  page%&gt;%
    html_nodes(&quot;.ldrow a b&quot;)%&gt;%
    html_text() %&gt;% as.tibble()
  number&lt;-     page%&gt;%
    html_nodes(&quot;.ldrow &gt; b&quot;)%&gt;%
    html_text() %&gt;% as.tibble()
  
  weight&lt;-page%&gt;%
    html_nodes(&quot;form tr:nth-child(4) .ldrow&quot;)%&gt;%
    html_text()%&gt;%
    str_replace_all(&quot;[\r\n]&quot; , &quot;&quot;)%&gt;%
    str_squish()%&gt;%
    str_extract(pattern =(&quot;(?&lt;=Weight:).*(?=Position:)&quot;))%&gt;%as.tibble()
  
  height&lt;-page%&gt;%
    html_nodes(&quot;form tr:nth-child(4) .ldrow&quot;)%&gt;%
    html_text()%&gt;%
    str_replace_all(&quot;[\r\n]&quot; , &quot;&quot;)%&gt;%
    str_squish()%&gt;%
    str_extract(pattern =(&quot;(?&lt;=Height:).*(?=Weight:)&quot;))%&gt;%as.tibble()
  
  draft_position &lt;- page%&gt;%
    html_nodes(&quot;tr:nth-child(5) .ldrow&quot;)%&gt;%
    html_text()%&gt;%
    str_replace_all(&quot;[\r\n]&quot; , &quot;&quot;)%&gt;%
    str_squish()%&gt;%
    str_extract(pattern =(&quot;(?&lt;=Drafted: ).*(?=by)&quot;))%&gt;%as.tibble()
  
  club_drafted &lt;- page%&gt;%
    html_nodes(&quot;tr:nth-child(5) .ldrow&quot;)%&gt;%
    html_text()%&gt;%str_replace_all(&quot;[\r\n]&quot; , &quot;&quot;)%&gt;%
    str_squish()%&gt;%
    str_remove(&quot;.*by&quot;) %&gt;% as.tibble()
  position &lt;-     page%&gt;%
    html_nodes(&quot;form tr:nth-child(4) .ldrow&quot;)%&gt;%
    html_text()%&gt;%
    str_replace_all(&quot;[\r\n]&quot; , &quot;&quot;)%&gt;%
    str_remove(&quot;.*Position: &quot;)%&gt;%
    str_squish() %&gt;% as.tibble()
  
  player_information &lt;- cbind.fill(player, playing.for, number, weight, height,draft_position, club_drafted, position)
  
  player_information &lt;- as.tibble(player_information)
  head(player_information)</code></pre>
<pre><code>## # A tibble: 1 x 8
##   V1       value     value1 value2  value3  value4         value5    value6
##   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt; 
## 1 Dominic… West Coa… #4     &quot; 87kg… &quot; 185c… Round 1, Pick… &quot; West C… Midfi…</code></pre>
</div>
